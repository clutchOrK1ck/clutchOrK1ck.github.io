---
import { getEntry, render } from "astro:content";
import { getIcon } from "../utils/iconMapper";
import { GamepadDirectional, 
  Swords, 
  Pickaxe } from "@lucide/astro";

const contactEntry = await getEntry("contact", "index");
const contact = contactEntry.data;
const { Content } = await render(contactEntry);

const SectionIcon = getIcon(contact.icon as any);
---

<footer class="footer footer-horizontal footer-center bg-base-200 py-10">
  <aside>
    <SectionIcon class="inline-block size-20" />
    <p class="max-w-xl m-auto text-lg">
      <Content />
    </p>
    <p class="flex items-center space-x-1 text-base-content/60">
      <span>Copyright © {new Date().getFullYear()} - Crafted by an Artisan <a class="link link-hover inline-flex justify-center items-center" href="https://lauroguedes.dev/"><Pickaxe class="size-3 inline-block mr-1"/>Lauro Guedes</a> - Extended by <a class="link link-hover inline-flex justify-center items-center" href="https://clutchOrK1ck.github.io"><GamepadDirectional class="size-3 inline-block mr-1"/>clutchOrKick</a></span>
    </p>
  </aside>
</footer>

<script define:vars={{ discord: contact.discordNickname }}>
  window.copyDiscord = function (btn) {
    if (!btn.dataset.originalHTML) {
      btn.dataset.originalHTML = btn.innerHTML;
    }

    const revertTime = 1000;

    navigator.clipboard.writeText(discord);

    if (!btn) return;

    if (btn.dataset.revertTimer) {
      clearTimeout(Number(btn.dataset.revertTimer));
    }

    btn.innerHTML = "Copied ✓";

    const timerId = window.setTimeout(() => {
      btn.innerHTML = btn.dataset.originalHTML;
      delete btn.dataset.revertTimer;
    }, revertTime);

    btn.dataset.revertTimer = String(timerId);
  };
</script>
